{"version":3,"sources":["constants/actionTypes/index.js","redux/holiday/actions.js","redux/weather/actions.js","redux/taipeiSpeedCameraPositions/actions.js","components/MuiModal.js","pages/taipeiSpeedCameraPositions/useTaipeiSpeedCameraPositions.js","components/MuiTextField.js","pages/taipeiSpeedCameraPositions/GoogleMaps.js","constants/googleMapsApiKey.js","pages/taipeiSpeedCameraPositions/MessageModal.js","pages/taipeiSpeedCameraPositions/index.js"],"names":["GET_HOLIDAY","GET_HOLIDAY_SUCCESS","GET_HOLIDAY_FAILURE","RESET_HOLIDAY","GET_WEATHER","GET_WEATHER_SUCCESS","GET_WEATHER_FAILURE","RESET_WEATHER","GET_TAIPEI_SPEED_CAMERA_POSITIONS","GET_TAIPEI_SPEED_CAMERA_POSITIONS_SUCCESS","GET_TAIPEI_SPEED_CAMERA_POSITIONS_FAILURE","RESET_TAIPEI_SPEED_CAMERA_POSITIONS","getHoliday","payload","type","getHolidaySuccess","getHolidayFailure","getWeather","getWeatherSuccess","getWeatherFailure","resettWeather","getTaipeiSpeedCameraPositions","getTaipeiSpeedCameraPositionsSuccess","getTaipeiSpeedCameraPositionsFailure","resettTaipeiSpeedCameraPositions","StyledModalContainer","styled","div","theme","mainText","secondBackground","highlight","MuiModal","open","handaleClose","children","onClose","useTaipeiSpeedCameraPositions","dispatch","useDispatch","taipeiSpeedCameraPositions","useSelector","state","taipeiSpeedCameraPositionsError","taipeiSpeedCameraPositionsLoading","getTaipeiSpeedCameraPositionsApi","axios","get","then","console","log","fakeMapsInformation","catch","err","getFakeTaipeiSpeedCameraPositions","a","latitudeAndLongitudeList","StyledTextField","TextField","MuiTextField","id","label","value","onChange","fullWidth","variant","defaultProps","undefined","StyledMapLoadError","error","StyledMapContainer","StyledListContainer","StyledPaper","Paper","StyledLocationOnIcon","LocationOnIcon","StyledList","List","StyledListItem","ListItem","$isSelected","$isNoMarker","hover","StyledListItemTextSecondary","span","withTheme","googleMapRef","useRef","cameraListRef","millisecond","Date","now","toString","slice","randomCharacter","alphabet","Math","floor","random","length","join","getRandomCharacter","mapId","useState","mapElementID","google","setGoogle","loadGoogleError","setLoadGoogleError","gMap","setGMap","infoWindow","setInfoWindow","createdMarkers","setCreatedMarkers","selectedCameraNo","setSelectedCameraNo","filterCameraList","setFilterCameraList","cameraItems","setCameraItems","useEffect","Loader","apiKey","process","version","load","res","newMap","maps","Map","current","center","lat","lng","zoom","mapTypeControl","styles","googleMapsStyleTheme","themeName","newInfoWindow","InfoWindow","content","disableAutoPan","markers","forEach","item","errorMessage","marker","Marker","position","location","map","addListener","infoWindowContent","features","speedLimit","address","setContent","no","message","setOptions","Object","keys","items","alignItems","ListItemIcon","ListItemText","primary","secondary","Divider","component","mark","setMap","cameraElement","document","querySelector","element","container","getBoundingClientRect","bottom","height","top","containerRect","isElementVisible","elementTop","containerTop","scrollTop","setContainerScrollY","role","dense","button","onClick","data","setCenter","handlePositionListClick","Box","display","justifyContent","Grid","xs","sm","ref","event","close","target","reg","RegExp","filtedList","filter","test","StyledMessageContent","StyledIcon","StyledNote","p","MessageModal","fontSize","href","index","messageModalIsOpen","setMessageModalIsOpen","className"],"mappings":"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","file":"static/js/7.3497e24a.chunk.js","sourcesContent":["// === holiday ===\r\nexport const GET_HOLIDAY = 'GET_HOLIDAY'\r\nexport const GET_HOLIDAY_SUCCESS = 'GET_HOLIDAY_SUCCESS'\r\nexport const GET_HOLIDAY_FAILURE = 'GET_HOLIDAY_FAILURE'\r\nexport const RESET_HOLIDAY = 'RESET_HOLIDAY'\r\n\r\n// === weather ===\r\nexport const GET_WEATHER = 'GET_WEATHER'\r\nexport const GET_WEATHER_SUCCESS = 'GET_WEATHER_SUCCESS'\r\nexport const GET_WEATHER_FAILURE = 'GET_WEATHER_FAILURE'\r\nexport const RESET_WEATHER = 'RESET_WEATHER'\r\n\r\n// === taipei speed camera position ===\r\nexport const GET_TAIPEI_SPEED_CAMERA_POSITIONS = 'GET_TAIPEI_SPEED_CAMERA_POSITIONS'\r\nexport const GET_TAIPEI_SPEED_CAMERA_POSITIONS_SUCCESS = 'GET_TAIPEI_SPEED_CAMERA_POSITIONS_SUCCESS'\r\nexport const GET_TAIPEI_SPEED_CAMERA_POSITIONS_FAILURE = 'GET_TAIPEI_SPEED_CAMERA_POSITIONS_FAILURE'\r\nexport const RESET_TAIPEI_SPEED_CAMERA_POSITIONS = 'RESET_TAIPEI_SPEED_CAMERA_POSITIONS'\r\n","import {\r\n    GET_HOLIDAY,\r\n    GET_HOLIDAY_SUCCESS,\r\n    GET_HOLIDAY_FAILURE,\r\n    RESET_HOLIDAY,\r\n} from '../../constants/actionTypes'\r\n\r\nexport const getHoliday = (payload) => ({\r\n    type: GET_HOLIDAY,\r\n    payload,\r\n})\r\n\r\nexport const getHolidaySuccess = (payload) => ({\r\n    type: GET_HOLIDAY_SUCCESS,\r\n    payload,\r\n})\r\n\r\nexport const getHolidayFailure = (payload) => ({\r\n    type: GET_HOLIDAY_FAILURE,\r\n    payload,\r\n})\r\n\r\nexport const resetHoliday = (payload) => ({\r\n    type: RESET_HOLIDAY,\r\n    payload,\r\n})","import {\r\n    GET_WEATHER,\r\n    GET_WEATHER_SUCCESS,\r\n    GET_WEATHER_FAILURE,\r\n    RESET_WEATHER,\r\n} from '../../constants/actionTypes'\r\n\r\nexport const getWeather = (payload) => ({\r\n    type: GET_WEATHER,\r\n    payload,\r\n})\r\n\r\nexport const getWeatherSuccess = (payload) => ({\r\n    type: GET_WEATHER_SUCCESS,\r\n    payload,\r\n})\r\n\r\nexport const getWeatherFailure = (payload) => ({\r\n    type: GET_WEATHER_FAILURE,\r\n    payload,\r\n})\r\n\r\nexport const resettWeather = (payload) => ({\r\n    type: RESET_WEATHER,\r\n    payload,\r\n})","import {\r\n    GET_TAIPEI_SPEED_CAMERA_POSITIONS,\r\n    GET_TAIPEI_SPEED_CAMERA_POSITIONS_SUCCESS,\r\n    GET_TAIPEI_SPEED_CAMERA_POSITIONS_FAILURE,\r\n    RESET_TAIPEI_SPEED_CAMERA_POSITIONS,\r\n} from '../../constants/actionTypes'\r\n\r\nexport const getTaipeiSpeedCameraPositions = (payload) => ({\r\n    type: GET_TAIPEI_SPEED_CAMERA_POSITIONS,\r\n    payload,\r\n})\r\n\r\nexport const getTaipeiSpeedCameraPositionsSuccess = (payload) => ({\r\n    type: GET_TAIPEI_SPEED_CAMERA_POSITIONS_SUCCESS,\r\n    payload,\r\n})\r\n\r\nexport const getTaipeiSpeedCameraPositionsFailure = (payload) => ({\r\n    type: GET_TAIPEI_SPEED_CAMERA_POSITIONS_FAILURE,\r\n    payload,\r\n})\r\n\r\nexport const resettTaipeiSpeedCameraPositions = (payload) => ({\r\n    type: RESET_TAIPEI_SPEED_CAMERA_POSITIONS,\r\n    payload,\r\n})","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\nimport Modal from '@material-ui/core/Modal'\r\n\r\nconst StyledModalContainer = styled.div`\r\nposition: absolute;\r\nwidth: 90%;\r\n@media (min-width: 600px){\r\n  width: 50%;\r\n}\r\ntext-align: center;\r\ncolor: ${({ theme }) => theme.mainText};\r\nbackground-color: ${({ theme }) => theme.secondBackground};\r\nborder: 2px solid ${({ theme }) => theme.highlight};\r\npadding: 2rem 1rem;\r\ntop: 50%;\r\nleft: 50%;\r\ntransform: translate(-50%, -50%);\r\n`\r\n\r\nconst MuiModal = ({\r\n  open,\r\n  handaleClose,\r\n  children,\r\n}) => {\r\n  return (\r\n    <Modal\r\n      open={open}\r\n      onClose={handaleClose}\r\n    >\r\n      <StyledModalContainer>\r\n        {children}\r\n      </StyledModalContainer>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nMuiModal.propTypes = {\r\n  open: PropTypes.bool.isRequired,\r\n  handaleClose: PropTypes.func.isRequired,\r\n  children: PropTypes.instanceOf(Object).isRequired,\r\n}\r\n\r\nexport default MuiModal\r\n","import { useDispatch, useSelector } from 'react-redux'\r\nimport axios from 'axios'\r\n\r\nimport {\r\n    getTaipeiSpeedCameraPositions,\r\n    getTaipeiSpeedCameraPositionsSuccess,\r\n    getTaipeiSpeedCameraPositionsFailure,\r\n} from '../../redux/actions'\r\n// import taipeiSpeedCameraPositionsFakeData from './devFakeData.json'\r\nimport fakeMapsInformation from './fakeMapsInformation.json'\r\n\r\n// import { GOOGLE_MAPS_API_KEY } from '../../constants/googleMapsApiKey'\r\n// // 用太多要繳費給 Google，先註解掉\r\n// const googleMapsClient = require('@google/maps').createClient({\r\n//     key: GOOGLE_MAPS_API_KEY,\r\n//     Promise: Promise\r\n// })\r\n\r\nconst useTaipeiSpeedCameraPositions = () => {\r\n    const dispatch = useDispatch()\r\n\r\n    const taipeiSpeedCameraPositions = useSelector((state) => state.taipeiSpeedCameraPositions.taipeiSpeedCameraPositions)\r\n    const taipeiSpeedCameraPositionsError = useSelector((state) => state.taipeiSpeedCameraPositions.taipeiSpeedCameraPositionsError)\r\n    const taipeiSpeedCameraPositionsLoading = useSelector((state) => state.taipeiSpeedCameraPositions.taipeiSpeedCameraPositionsLoading)\r\n\r\n    // // 用太多要繳費給 Google，先註解掉\r\n    // const getLatitudeAndLongitude = (address) => (\r\n    //     googleMapsClient.geocode({ address })\r\n    //         .asPromise()\r\n    //         .then((response) => {\r\n    //             return ({\r\n    //                 formatted_address: response.json.results[0].formatted_address,\r\n    //                 location: response.json.results[0].geometry.location,\r\n    //             })\r\n    //         })\r\n    //         .catch((err) => {\r\n    //             return { errorMessage: err.message }\r\n    //         })\r\n    // )\r\n\r\n    // // 用太多要繳費給 Google，先註解掉\r\n    // const creatMapsInformation = async (taipeiSpeedCameraPositionsData) => (\r\n    //     await Promise.all(taipeiSpeedCameraPositionsData.map(async (item) => {\r\n    //         const { setRoad,\r\n    //             setPosition,\r\n    //         } = item\r\n    //         const address = `臺北市 ${setRoad} ${setPosition}`\r\n    //         const latitudeAndLongitude = await getLatitudeAndLongitude(address)\r\n    //         return {\r\n    //             ...item,\r\n    //             address,\r\n    //             ...latitudeAndLongitude,\r\n    //         }\r\n    //     }))\r\n    // )\r\n\r\n    const getTaipeiSpeedCameraPositionsApi = () => {\r\n        dispatch(getTaipeiSpeedCameraPositions())\r\n\r\n        axios.get('https://data.taipei/api/getDatasetInfo/downloadResource?id=745b8808-061f-4f5b-9a62-da1590c049a9&rid=5012e8ba-5ace-4821-8482-ee07c147fd0a')\r\n            .then(() => {\r\n                // 因為 api 不支援跨網域\r\n                // 且來源只提供 csv 檔，還要轉乘 json\r\n                // 永遠跑不到這裡\r\n                // 用太多要繳費給 Google，先註解掉\r\n                // const latitudeAndLongitudeList = await creatMapsInformation(taipeiSpeedCameraPositionsFakeData)\r\n                // dispatch(getTaipeiSpeedCameraPositionsSuccess(latitudeAndLongitudeList))\r\n\r\n                // 萬一成功也先用假資料\r\n                console.log('竟然打成功了!?')\r\n                dispatch(getTaipeiSpeedCameraPositionsSuccess(fakeMapsInformation))\r\n            })\r\n            .catch((err) => {\r\n                dispatch(getTaipeiSpeedCameraPositionsFailure(err))\r\n            })\r\n    }\r\n\r\n    const getFakeTaipeiSpeedCameraPositions = async () => {\r\n        // // 用太多要繳費給 Google，先註解掉\r\n        // const latitudeAndLongitudeList = await creatMapsInformation(taipeiSpeedCameraPositionsFakeData)\r\n\r\n        // creatMapsInformation 產生的資料\r\n        const latitudeAndLongitudeList = fakeMapsInformation\r\n\r\n        dispatch(getTaipeiSpeedCameraPositionsSuccess(latitudeAndLongitudeList))\r\n    }\r\n\r\n    return {\r\n        taipeiSpeedCameraPositions,\r\n        taipeiSpeedCameraPositionsError,\r\n        taipeiSpeedCameraPositionsLoading,\r\n        // getLatitudeAndLongitude,\r\n        // creatMapsInformation,\r\n        getTaipeiSpeedCameraPositionsApi,\r\n        getFakeTaipeiSpeedCameraPositions,\r\n    }\r\n}\r\n\r\nexport default useTaipeiSpeedCameraPositions\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\n\r\nimport TextField from '@material-ui/core/TextField'\r\n\r\n\r\nconst StyledTextField = styled(TextField)`\r\n.MuiFormLabel-root,\r\n.MuiOutlinedInput-input {\r\n    color: ${({ theme }) => theme.mainText};\r\n}\r\n\r\n.MuiOutlinedInput-notchedOutline {\r\n    border-color: ${({ theme }) => theme.mainText};\r\n}\r\n\r\n.MuiOutlinedInput-root:hover .MuiOutlinedInput-notchedOutline,\r\n.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline\r\n{\r\n    border-color: ${({ theme }) => theme.highlight};\r\n}\r\n\r\n.MuiFormLabel-root.Mui-focused {\r\n    color: ${({ theme }) => theme.highlight};\r\n}\r\n`\r\n\r\nconst MuiTextField = ({\r\n    id,\r\n    label,\r\n    value,\r\n    onChange,\r\n    fullWidth,\r\n    variant,\r\n}) => {\r\n    return (\r\n        <StyledTextField\r\n            id={id}\r\n            label={label}\r\n            value={value}\r\n            onChange={onChange}\r\n            fullWidth={fullWidth}\r\n            variant={variant}\r\n        />\r\n    )\r\n}\r\n\r\nMuiTextField.defaultProps = {\r\n    id: undefined,\r\n    label: undefined,\r\n    value: undefined,\r\n    onChange: null,\r\n    fullWidth: false,\r\n    variant: 'outlined',\r\n}\r\nMuiTextField.propTypes = {\r\n    id: PropTypes.string,\r\n    label: PropTypes.string,\r\n    value: PropTypes.string,\r\n    onChange: PropTypes.func,\r\n    fullWidth: PropTypes.bool,\r\n    variant: PropTypes.string,\r\n}\r\n\r\nexport default MuiTextField\r\n","import React, { useEffect, useState, Fragment, useRef } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled, { withTheme } from 'styled-components'\r\nimport { Loader } from '@googlemaps/js-api-loader'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport WarningRoundedIcon from '@material-ui/icons/WarningRounded'\r\nimport Box from '@material-ui/core/Box'\r\n\r\nimport { MuiLoadingPage } from '../../components/muiCircularProgress'\r\nimport MuiTextField from '../../components/MuiTextField'\r\nimport { GOOGLE_MAPS_API_KEY } from '../../constants/googleMapsApiKey'\r\n\r\nimport useTaipeiSpeedCameraPositions from './useTaipeiSpeedCameraPositions'\r\n// google map style 產生器 https://mapstyle.withgoogle.com/\r\nimport googleMapsStyleTheme from './googleMapsStyleTheme.json'\r\n\r\nconst StyledMapLoadError = styled.div`\r\npadding: 2rem;\r\ncolor: ${({ theme }) => theme.error}};\r\n`\r\n\r\nconst StyledMapContainer = styled.div`\r\nwdth: 100%;\r\nheight: 50vh;\r\nposition: relative;\r\n\r\n@media (min-width: 600px) {\r\n    height: 80vh;\r\n}\r\n`\r\nconst StyledListContainer = styled.div`\r\nheight: 30vh;\r\noverflow-y: hidden;\r\n\r\n@media (min-width: 600px) {\r\n    height: 80vh;\r\n}\r\n`\r\n\r\nconst StyledPaper = styled(Paper)`\r\nbackground-color: ${({ theme }) => theme.secondBackground} !important;\r\n`\r\n\r\nconst StyledLocationOnIcon = styled(LocationOnIcon)`\r\nwidth: 39px !important;\r\nheight: 39px !important;\r\n`\r\n\r\nconst StyledList = styled(List)`\r\nheight: calc(100% - 80px);\r\noverflow: auto;\r\n`\r\n\r\nconst StyledListItem = styled(ListItem)`\r\ncolor: ${({ theme, $isSelected, $isNoMarker }) => {\r\n        if ($isSelected) return theme.highlight\r\n        else if ($isNoMarker) return theme.error\r\n        return theme.mainText\r\n    }} !important;\r\nbackground-color: ${({ theme, $isSelected }) => $isSelected ? theme.hover : ''} !important;\r\n\r\n.MuiListItemIcon-root .MuiSvgIcon-root,\r\n.MuiTypography-colorTextSecondary {\r\n    color: ${({ theme, $isSelected, $isNoMarker }) => {\r\n        if ($isSelected) return theme.highlight\r\n        else if ($isNoMarker) return theme.error\r\n        return theme.mainText\r\n    }} !important;\r\n}\r\n\r\n:hover {\r\n    color: ${({ theme }) => theme.highlight};\r\n    background-color: ${({ theme }) => theme.hover} !important;\r\n\r\n    .MuiListItemIcon-root .MuiSvgIcon-root,\r\n    .MuiListItemText-root\r\n    .MuiTypography-colorTextSecondary {\r\n        color: ${({ theme }) => theme.highlight};\r\n    }\r\n}\r\n`\r\n\r\nconst StyledListItemTextSecondary = styled.span`\r\ndisplay: block;\r\n`\r\n\r\nconst getRandomCharacter = () => {\r\n    const alphabet = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\r\n    return [\r\n        alphabet[Math.floor(Math.random() * alphabet.length)],\r\n        alphabet[Math.floor(Math.random() * alphabet.length)],\r\n        alphabet[Math.floor(Math.random() * alphabet.length)],\r\n    ].join('')\r\n}\r\n\r\nconst GoogleMaps = ({ theme }) => {\r\n    const { taipeiSpeedCameraPositions } = useTaipeiSpeedCameraPositions()\r\n    const googleMapRef = useRef()\r\n    const cameraListRef = useRef()\r\n\r\n    const millisecond = Date.now().toString().slice(-3)\r\n    const randomCharacter = getRandomCharacter()\r\n    const mapId = `map-${randomCharacter + millisecond}`\r\n    const [mapElementID] = useState(mapId)\r\n\r\n    const [google, setGoogle] = useState(undefined)\r\n    const [loadGoogleError, setLoadGoogleError] = useState(undefined)\r\n    const [gMap, setGMap] = useState(undefined)\r\n    const [infoWindow, setInfoWindow] = useState(undefined)\r\n    const [createdMarkers, setCreatedMarkers] = useState({})\r\n    const [selectedCameraNo, setSelectedCameraNo] = useState('')\r\n    const [filterCameraList, setFilterCameraList] = useState(taipeiSpeedCameraPositions)\r\n    const [cameraItems, setCameraItems] = useState(null)\r\n\r\n    const handleSearchFieldChange = (event) => {\r\n        setSelectedCameraNo('')\r\n        infoWindow.close()\r\n        taipeiSpeedCameraPositions.forEach((item) => {\r\n            if (item.errorMessage) {\r\n                return\r\n            }\r\n            createdMarkers[item.no].setMap(null)\r\n        })\r\n\r\n        if (event.target.value) {\r\n            const reg = new RegExp(event.target.value, 'g')\r\n            const filtedList = taipeiSpeedCameraPositions.filter((item) => (\r\n                reg.test(item.address) || reg.test(`限速 ${item.speedLimit}`) || reg.test(item.features)))\r\n            setFilterCameraList(filtedList)\r\n        } else {\r\n            setFilterCameraList(taipeiSpeedCameraPositions)\r\n        }\r\n    }\r\n\r\n    const handlePositionListClick = (data) => {\r\n        gMap.setCenter(data.location)\r\n\r\n        const infoWindowContent = `\r\n            <div style=\"color: #ea4335;\">\r\n                <div>${data.features} - 限速 ${data.speedLimit}<div>\r\n                    <div>${data.address}</div>\r\n                </div>\r\n                    `\r\n        infoWindow.setContent(infoWindowContent)\r\n        infoWindow.open(gMap, createdMarkers[data.no])\r\n\r\n        setSelectedCameraNo(data.no)\r\n    }\r\n\r\n    useEffect(() => {\r\n        const loader = new Loader({\r\n            apiKey: GOOGLE_MAPS_API_KEY,\r\n            version: 'weekly',\r\n        })\r\n\r\n        loader.load().then((res) => {\r\n            setGoogle(res)\r\n\r\n            const newMap = new res.maps.Map(googleMapRef.current, {\r\n                center: { lat: 25.047802296330403, lng: 121.5177953369906 },\r\n                zoom: 12,\r\n                mapTypeControl: false,\r\n                styles: googleMapsStyleTheme[theme.themeName],\r\n            })\r\n            setGMap(newMap)\r\n\r\n            const newInfoWindow = new res.maps.InfoWindow({\r\n                content: '',\r\n                disableAutoPan: true,\r\n            })\r\n            setInfoWindow(newInfoWindow)\r\n\r\n            let markers = {}\r\n            taipeiSpeedCameraPositions.forEach((item) => {\r\n                if (item.errorMessage) {\r\n                    return\r\n                }\r\n\r\n                const marker = new res.maps.Marker({\r\n                    position: item.location,\r\n                    map: null,\r\n                })\r\n                marker.addListener(\"click\", () => {\r\n                    const infoWindowContent = `\r\n                    <div style=\"color: #ea4335;\">\r\n                        <div>${item.features} - 限速 ${item.speedLimit}<div>\r\n                        <div>${item.address}</div>\r\n                    </div>\r\n                    `\r\n                    newInfoWindow.setContent(infoWindowContent)\r\n                    newInfoWindow.open(gMap, marker)\r\n\r\n                    setSelectedCameraNo(item.no)\r\n                })\r\n                markers[item.no] = marker\r\n            })\r\n            setCreatedMarkers(markers)\r\n        }).catch((err) => {\r\n            console.log('err.message', err.message)\r\n            setLoadGoogleError(err.message)\r\n        })\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (gMap) {\r\n            gMap.setOptions({\r\n                styles: googleMapsStyleTheme[theme.themeName]\r\n            })\r\n        }\r\n    }, [theme.themeName])\r\n\r\n    const isElementVisible = (element, container) => {\r\n        const { bottom, height, top } = element.getBoundingClientRect()\r\n        const containerRect = container.getBoundingClientRect()\r\n\r\n        return top <= containerRect.top ? containerRect.top - top <= height : bottom - containerRect.bottom <= height\r\n    }\r\n\r\n    const setContainerScrollY = (element, container) => {\r\n        const { top: elementTop } = element.getBoundingClientRect()\r\n        const { top: containerTop } = container.getBoundingClientRect()\r\n        container.scrollTop += elementTop - containerTop\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (gMap\r\n            && Object.keys(createdMarkers).length > 0\r\n        ) {\r\n            const items = filterCameraList.map((item) => {\r\n                if (item.errorMessage) {\r\n                    return (\r\n                        <Fragment key={`${item.no}`}>\r\n                            <StyledListItem\r\n                                alignItems=\"flex-start\"\r\n                                $isSelected={false}\r\n                                $isNoMarker\r\n                            >\r\n                                <ListItemIcon>\r\n                                    <StyledLocationOnIcon />\r\n                                </ListItemIcon>\r\n                                <ListItemText\r\n                                    primary={`${item.features} - 限速 ${item.speedLimit}`}\r\n                                    secondary={\r\n                                        <>\r\n                                            <StyledListItemTextSecondary>{item.address}</StyledListItemTextSecondary>\r\n                                            <StyledListItemTextSecondary>經緯度轉換失敗，無法產生地標</StyledListItemTextSecondary>\r\n                                        </>\r\n                                    }\r\n                                />\r\n                            </StyledListItem>\r\n                            <Divider variant=\"inset\" component=\"li\" />\r\n                        </Fragment>\r\n                    )\r\n                }\r\n\r\n                const mark = createdMarkers[item.no]\r\n                mark.setMap(gMap)\r\n                mark.addListener(\"click\", () => {\r\n                    const cameraElement = document.querySelector(`#camera-${item.no}`)\r\n                    if (isElementVisible(cameraElement, cameraListRef.current) === false) {\r\n                        setContainerScrollY(cameraElement, cameraListRef.current)\r\n                    }\r\n                })\r\n\r\n                return (\r\n                    <Fragment key={`${item.no}`}>\r\n                        <StyledListItem\r\n                            alignItems=\"flex-start\"\r\n                            role={undefined}\r\n                            dense\r\n                            button\r\n                            onClick={() => handlePositionListClick(item)}\r\n                            $isSelected={selectedCameraNo === item.no}\r\n                            id={`camera-${item.no}`}\r\n                        >\r\n                            <ListItemIcon>\r\n                                <StyledLocationOnIcon />\r\n                            </ListItemIcon>\r\n                            <ListItemText\r\n                                primary={`${item.features} - 限速 ${item.speedLimit}`}\r\n                                secondary={item.address}\r\n                            />\r\n                        </StyledListItem>\r\n                        <Divider variant=\"inset\" component=\"li\" />\r\n                    </Fragment>\r\n                )\r\n            })\r\n\r\n            setCameraItems(items)\r\n        }\r\n    }, [gMap, createdMarkers, filterCameraList, selectedCameraNo])\r\n\r\n    return (\r\n        <StyledPaper>\r\n            {loadGoogleError &&\r\n                <StyledMapLoadError>\r\n                    <Box display=\"flex\" justifyContent=\"center\">\r\n                        <Box>\r\n                            <WarningRoundedIcon />\r\n                        </Box>\r\n                        <Box>\r\n                            系統發生異常\r\n                        </Box>\r\n                    </Box>\r\n                </StyledMapLoadError>\r\n            }\r\n            {!loadGoogleError &&\r\n                <Grid container>\r\n                    <Grid item xs={12} sm={!google && !gMap ? 12 : 8}>\r\n                        <StyledMapContainer id={mapElementID} ref={googleMapRef}>\r\n                            {!google && !gMap &&\r\n                                <MuiLoadingPage />\r\n                            }\r\n                        </StyledMapContainer>\r\n                    </Grid>\r\n                    {cameraItems &&\r\n                        <Grid item xs={12} sm={4}>\r\n                            <StyledListContainer>\r\n                                <List>\r\n                                    <StyledListItem role={undefined} dense>\r\n                                        <MuiTextField\r\n                                            label=\"Search...\"\r\n                                            onChange={handleSearchFieldChange}\r\n                                            fullWidth\r\n                                        />\r\n                                    </StyledListItem>\r\n                                </List>\r\n                                <StyledList ref={cameraListRef}>\r\n                                    {cameraItems}\r\n                                </StyledList>\r\n                            </StyledListContainer>\r\n                        </Grid>\r\n                    }\r\n                </Grid>\r\n            }\r\n        </StyledPaper>\r\n    )\r\n}\r\nGoogleMaps.propTypes = {\r\n    theme: PropTypes.instanceOf(Object).isRequired,\r\n}\r\n\r\nexport default withTheme(GoogleMaps)\r\n","export const GOOGLE_MAPS_API_KEY = process.env.REACT_APP_GOOGLE_MAPS_API_KEY","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport ErrorIcon from '@material-ui/icons/Error'\r\n\r\nconst StyledMessageContent = styled.div`\r\ntext-align: left;\r\n`\r\nconst StyledIcon = styled.div`\r\ncolor: ${({ theme }) => theme.highlight};\r\n`\r\n\r\nconst StyledNote = styled.p`\r\ncolor: ${({ theme }) => theme.highlight};\r\n`\r\n\r\nconst MessageModal = () => {\r\n  return (\r\n    <>\r\n      <StyledIcon>\r\n        <ErrorIcon fontSize=\"large\" />\r\n      </StyledIcon>\r\n      <StyledMessageContent>\r\n        <StyledNote>\r\n          api僅提供中文地址，經緯度是透過 google api geocode 轉換的，因此\r\n        </StyledNote>\r\n        <StyledNote>\r\n          1. 會有一些地址在轉換時 api 會找不到經緯度，地圖上不會顯示地標\r\n        </StyledNote>\r\n        <StyledNote>\r\n          2. 地圖上的地標只會是大略的位置，還請參照文字給的地址來確認\r\n        </StyledNote>\r\n        <br />\r\n        <p>因為 api 不支援跨網域，且來源只提供 csv 檔，呈現資料為手動更新，故有可能不會有最新資料。</p>\r\n        <br />\r\n        <p>資料最後更新日期: 2021-11-17 09:25:55</p>\r\n        <p>資料來源: </p>\r\n        <p>\r\n          <a href=\"https://data.taipei/#/dataset/detail?id=745b8808-061f-4f5b-9a62-da1590c049a9\">\r\n            臺北市資料大平臺\r\n          </a>\r\n        </p>\r\n      </StyledMessageContent>\r\n    </>\r\n  )\r\n}\r\n\r\nMessageModal.propTypes = {\r\n\r\n}\r\n\r\nexport default MessageModal\r\n","import React, { useEffect, useState } from 'react'\r\nimport { useDispatch } from 'react-redux'\r\n\r\nimport {\r\n    resettTaipeiSpeedCameraPositions,\r\n} from '../../redux/actions'\r\n\r\nimport { MuiPageSpinner } from '../../components/muiCircularProgress'\r\nimport MuiModal from '../../components/MuiModal'\r\n\r\nimport useTaipeiSpeedCameraPositions from './useTaipeiSpeedCameraPositions'\r\nimport GoogleMaps from './GoogleMaps'\r\nimport MessageModal from './MessageModal'\r\n\r\nconst index = () => {\r\n    const dispatch = useDispatch()\r\n\r\n    const {\r\n        taipeiSpeedCameraPositions,\r\n        taipeiSpeedCameraPositionsLoading,\r\n        taipeiSpeedCameraPositionsError,\r\n        getTaipeiSpeedCameraPositionsApi,\r\n        getFakeTaipeiSpeedCameraPositions,\r\n    } = useTaipeiSpeedCameraPositions()\r\n\r\n    useEffect(() => {\r\n        getTaipeiSpeedCameraPositionsApi()\r\n        return () => dispatch(resettTaipeiSpeedCameraPositions())\r\n    }, [])\r\n\r\n    const [messageModalIsOpen, setMessageModalIsOpen] = useState(false)\r\n    const handaleMessageModalOpen = () => { setMessageModalIsOpen(true) }\r\n    const handaleMessageModalClose = () => { setMessageModalIsOpen(false) }\r\n\r\n    // 因為 api 不支援跨網域，且來源只提共csv檔\r\n    // 故多了此步驟\r\n    useEffect(() => {\r\n        if (taipeiSpeedCameraPositionsError !== null && taipeiSpeedCameraPositions.length === 0) {\r\n            console.log('use fake data')\r\n            getFakeTaipeiSpeedCameraPositions()\r\n            handaleMessageModalOpen()\r\n        }\r\n    }, [taipeiSpeedCameraPositionsError])\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"page-title\">臺北市固定測速照相地點</div>\r\n            {taipeiSpeedCameraPositionsLoading &&\r\n                <MuiPageSpinner />\r\n            }\r\n            {taipeiSpeedCameraPositionsLoading === false && taipeiSpeedCameraPositions.length > 0 &&\r\n                <GoogleMaps />\r\n            }\r\n            <MuiModal\r\n                open={messageModalIsOpen}\r\n                handaleClose={handaleMessageModalClose}\r\n            >\r\n                <MessageModal />\r\n            </MuiModal>\r\n        </div>\r\n    )\r\n}\r\n\r\nindex.propTypes = {\r\n\r\n}\r\n\r\nexport default (index)\r\n"],"sourceRoot":""}